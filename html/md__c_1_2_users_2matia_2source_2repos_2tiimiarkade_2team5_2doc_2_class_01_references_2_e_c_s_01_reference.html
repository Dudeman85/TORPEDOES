<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tiimi Arkade: Entity Component System</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tiimi Arkade<span id="projectnumber">&#160;0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__c_1_2_users_2matia_2source_2repos_2tiimiarkade_2team5_2doc_2_class_01_references_2_e_c_s_01_reference.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Entity Component System</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md3"></a> This reference is meant to explain how to use the ECS architecture on a surface level. For more information on how it actually works, see <em>ECS Report.docx (outdated)</em>.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
ECS Basics</h1>
<p>The ECS architectures consists of entities, components, and systems.<br  />
 <b>Entities are IDs and can be though of similarly to game objects.</b><br  />
 <b>Components store data attached to entities.</b><br  />
 <b>Systems operate upon the data in components.</b> Each system has required components it needs to operate; if an entity has every required component it will be operated upon by the system.</p>
<p>All of the ECS functionality is in <b><a class="el" href="_e_c_s_8h.html">engine/ECS.h</a></b> and under the namespace <b><a class="el" href="namespaceengine_1_1ecs.html">engine::ecs</a></b> </p><div class="fragment"><div class="line"><span class="comment">//The ECS implementation, this is unnecessary if you include engine/Application.h</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_e_c_s_8h.html">engine/ECS.h</a>&gt;</span> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//Probably want to use this</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceengine.html">engine</a>;</div>
<div class="ttc" id="a_e_c_s_8h_html"><div class="ttname"><a href="_e_c_s_8h.html">ECS.h</a></div></div>
<div class="ttc" id="anamespaceengine_html"><div class="ttname"><a href="namespaceengine.html">engine</a></div><div class="ttdef"><b>Definition</b> Application.h:21</div></div>
</div><!-- fragment --><hr  />
 <h1><a class="anchor" id="autotoc_md6"></a>
Entity</h1>
<p>Entities are IDs. They have no data or methods themselves and can be though of as gaining the attributes of the components attached to them. <b>0 will never be a valid entity.</b> </p><div class="fragment"><div class="line"><span class="comment">//Example entity</span></div>
<div class="line"><span class="comment">//This is just an id with no actual data</span></div>
<div class="line"><a class="code hl_typedef" href="namespaceengine_1_1ecs.html#a90c875748d9ff922fa1407acc0187560">ecs::Entity</a> player = ecs::NewEntity();</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Destroys an entity along with all of its components</span></div>
<div class="line">ecs::DestroyEntity(player);</div>
<div class="ttc" id="anamespaceengine_1_1ecs_html_a90c875748d9ff922fa1407acc0187560"><div class="ttname"><a href="namespaceengine_1_1ecs.html#a90c875748d9ff922fa1407acc0187560">engine::ecs::Entity</a></div><div class="ttdeci">uint32_t Entity</div><div class="ttdef"><b>Definition</b> ECS.h:38</div></div>
</div><!-- fragment --><hr  />
 <h1><a class="anchor" id="autotoc_md8"></a>
Component</h1>
<p>Components are aggregate structs or classes, meaning no user defined constructors, and no private or virtual members! They are initialized with a designated initializer {}, just like arrays. Since components should not have any methods, it is good to keep them as structs.</p>
<p>Every component type also must be registered before it can be used. </p><div class="fragment"><div class="line"><span class="comment">//Example custom component</span></div>
<div class="line"><a class="code hl_define" href="_e_c_s_8h.html#a8e7170c0608045c2a7709451b4dd711e">ECS_REGISTER_COMPONENT</a>(Position)</div>
<div class="line"><span class="keyword">struct </span>Position</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">float</span> <a class="code hl_variable" href="simple_8c.html#aca70cc1e1baa809c00f9f8bffe935a91">x</a>, <a class="code hl_variable" href="simple_8c.html#ae2cad7d6233fb389cf2e3b6aaf77b997">y</a>, <a class="code hl_variable" href="_open_g_l_8cpp.html#adabda259f597fb76d29e32cb3add181c">z</a>;</div>
<div class="line">};</div>
<div class="ttc" id="a_e_c_s_8h_html_a8e7170c0608045c2a7709451b4dd711e"><div class="ttname"><a href="_e_c_s_8h.html#a8e7170c0608045c2a7709451b4dd711e">ECS_REGISTER_COMPONENT</a></div><div class="ttdeci">#define ECS_REGISTER_COMPONENT(COMPONENT)</div><div class="ttdef"><b>Definition</b> ECS.h:20</div></div>
<div class="ttc" id="a_open_g_l_8cpp_html_adabda259f597fb76d29e32cb3add181c"><div class="ttname"><a href="_open_g_l_8cpp.html#adabda259f597fb76d29e32cb3add181c">z</a></div><div class="ttdeci">GLdouble GLdouble GLdouble z</div><div class="ttdef"><b>Definition</b> OpenGL.cpp:346</div></div>
<div class="ttc" id="asimple_8c_html_aca70cc1e1baa809c00f9f8bffe935a91"><div class="ttname"><a href="simple_8c.html#aca70cc1e1baa809c00f9f8bffe935a91">x</a></div><div class="ttdeci">float x</div><div class="ttdef"><b>Definition</b> simple.c:38</div></div>
<div class="ttc" id="asimple_8c_html_ae2cad7d6233fb389cf2e3b6aaf77b997"><div class="ttname"><a href="simple_8c.html#ae2cad7d6233fb389cf2e3b6aaf77b997">y</a></div><div class="ttdeci">float y</div><div class="ttdef"><b>Definition</b> simple.c:38</div></div>
</div><!-- fragment --><p>Adding and getting components to entities can be done as such: </p><div class="fragment"><div class="line"><span class="comment">//Add the component to an entity</span></div>
<div class="line">ecs::AddComponent(player, Position{ .x = 10.0f, .y = 25.25f, .z = 0.0f});</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Make sure the entity has the component, this is usually not necessary if your system is designed properly</span></div>
<div class="line"><span class="keywordflow">if</span>(ecs::HasComponent&lt;Position&gt;(player))</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//Get the player entity&#39;s position component</span></div>
<div class="line">    Position&amp; position = ecs::GetComponent&lt;Position&gt;(player);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//You can read/write to the members of a component directly</span></div>
<div class="line">    position.x = 5.1f;</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
 <h1><a class="anchor" id="autotoc_md10"></a>
System</h1>
<p>Systems are esentially collections of functions that operate upon data in components. Each system has a list of required components it needs to operate which needs to be given manually, as well as a list of entities with those required components which is automaticaly set by the ECS implementation. For example, a render system could require Sprite and Transform components. It would then automatically operate upon every entity with at least those components.</p>
<p>Every system must be a class that inherits from the System class which contains the list of all entities with the required components.</p>
<p>Systems should have an Update and an Init function, although these are not strictly required. The update function should have a loop which iterates through each entity in the entities set. The loop should be done exactly like below. Avoid using constructors and instead do setup in Init. </p><div class="fragment"><div class="line"><span class="comment">//Example Gravity System</span></div>
<div class="line"><span class="comment">//Requires Position component</span></div>
<div class="line"><a class="code hl_define" href="_e_c_s_8h.html#ac1d0503cf72874d751c41f785fd4f5e7">ECS_REGISTER_SYSTEM</a>(GravitySystem, Position)</div>
<div class="line"><span class="keyword">class </span>GravitySystem : <span class="keyword">public</span> ecs::System</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">//The Init function of the Gravity system should be called once before the game loop</span></div>
<div class="line">    <span class="keywordtype">void</span> Init(<a class="code hl_class" href="classengine_1_1_vector3.html">Vector3</a> <a class="code hl_variable" href="simple_8c.html#a8cf17d727651616de6f2b79ef32170cd">g</a>)</div>
<div class="line">    {</div>
<div class="line">        gravity = <a class="code hl_variable" href="simple_8c.html#a8cf17d727651616de6f2b79ef32170cd">g</a>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//The Update function of the Gravity system should be called every frame</span></div>
<div class="line">    <span class="keywordtype">void</span> Update(<span class="keywordtype">float</span> deltaTime)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//Loop through each entity available to this system</span></div>
<div class="line">        <span class="comment">//The loop should be done like this to avoid invalid iterators when deleting entities</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> itr = entities.begin(); itr != entities.end();)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">//Get the entity and increment the iterator</span></div>
<div class="line">            <a class="code hl_typedef" href="namespaceengine_1_1ecs.html#a90c875748d9ff922fa1407acc0187560">ecs::Entity</a> entity = *itr++;</div>
<div class="line">        </div>
<div class="line">            <span class="comment">//Get the Position component of the entity</span></div>
<div class="line">            <span class="comment">//There is no need to make sure it has one since the ECS manager takes care of that</span></div>
<div class="line">            Position&amp; position = ecs::GetComponent&lt;Position&gt;(entity);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">//Operate upon the data in the entity&#39;s Position component</span></div>
<div class="line">            position.x += gravity.x;</div>
<div class="line">            position.y += gravity.y;</div>
<div class="line">            position.z += gravity.z;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_class" href="classengine_1_1_vector3.html">Vector3</a> gravity = <a class="code hl_class" href="classengine_1_1_vector3.html">Vector3</a>(0, -9.81, 0);</div>
<div class="line">}</div>
<div class="ttc" id="a_e_c_s_8h_html_ac1d0503cf72874d751c41f785fd4f5e7"><div class="ttname"><a href="_e_c_s_8h.html#ac1d0503cf72874d751c41f785fd4f5e7">ECS_REGISTER_SYSTEM</a></div><div class="ttdeci">#define ECS_REGISTER_SYSTEM(SYSTEM,...)</div><div class="ttdef"><b>Definition</b> ECS.h:25</div></div>
<div class="ttc" id="aclassengine_1_1_vector3_html"><div class="ttname"><a href="classengine_1_1_vector3.html">engine::Vector3</a></div><div class="ttdef"><b>Definition</b> Vector.h:66</div></div>
<div class="ttc" id="asimple_8c_html_a8cf17d727651616de6f2b79ef32170cd"><div class="ttname"><a href="simple_8c.html#a8cf17d727651616de6f2b79ef32170cd">g</a></div><div class="ttdeci">float g</div><div class="ttdef"><b>Definition</b> simple.c:39</div></div>
</div><!-- fragment --><p>Most ECS system functions that operate upon only one entity don't usually need to be members of the system class. However, they should be static members for the sake of organization. </p><div class="fragment"><div class="line"><span class="comment">//These are equivalent</span></div>
<div class="line">TranformSystem::SetPosition(entity, <a class="code hl_class" href="classengine_1_1_vector3.html">Vector3</a>(100, 100, 100));</div>
<div class="line">engine::tranformSystem-&gt;SetPosition(entity, <a class="code hl_class" href="classengine_1_1_vector3.html">Vector3</a>(100, 100, 100));</div>
</div><!-- fragment --><p>All you need to do now is get a reference to the system and call Update in your game loop:</p>
<div class="fragment"><div class="line"><span class="comment">//Get the gravity system</span></div>
<div class="line">std::shared_ptr&lt;GravitySystem&gt; gravitySystem = ecs::GetSystem&lt;GravitySystem&gt;();</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Call init before game loop</span></div>
<div class="line">gravitySystem-&gt;Init();</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Game loop</span></div>
<div class="line"><span class="keywordflow">while</span>(<span class="keyword">true</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//Now you can use the gravity system</span></div>
<div class="line">    <span class="comment">//It will automatically operate upon every entity with the Position component</span></div>
<div class="line">    gravitySystem-&gt;Update();</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
